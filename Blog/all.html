<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>  
	
  	
  	
	</title>

  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="atom.xml" rel="alternate" title="" type="application/atom+xml">

	<link href="asset/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="asset/stylesheets/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	<script src="asset/javascripts/jquery.min.js"></script>
	<script src="asset/highlightjs/highlight.pack.js"></script>
	<link href="asset/highlightjs/styles/solarized_dark.css" media="screen, projection" rel="stylesheet" type="text/css">
<script>hljs.initHighlightingOnLoad();</script>

	<!--[if lt IE 9]><script src="asset/javascripts/html5.js"></script><![endif]-->
	<!-- <link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'> -->
	<style type="text/css">
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 300;
  src: local('Nunito-Light'), url(asset/font/1TiHc9yag0wq3lDO9cw0voX0hVgzZQUfRDuZrPvH3D8.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 400;
  src: local('Nunito-Regular'), url(asset/font/6TbRXKWJjpj6V2v_WyRbMX-_kf6ByYO6CLYdB4HQE-Y.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
/* latin */
@font-face {
  font-family: 'Nunito';
  font-style: normal;
  font-weight: 700;
  src: local('Nunito-Bold'), url(asset/font/TttUCfJ272GBgSKaOaD7KoX0hVgzZQUfRDuZrPvH3D8.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
}
	</style>
	
	<style type="text/css">
	.container .left-col{ opacity: 1;}
	#pagenavi a{ font-size: 1.3em;}
	#pagenavi .next:before{ top: 3px;}
	#pagenavi .prev:before{ top: 3px;}
	.container .mid-col .mid-col-container #content .archives .title{ font-size: 1.5em;}
	.container .mid-col .mid-col-container #content article{ padding: 15px 0px;}
	#header .subtitle {
		line-height: 1.2em;
		padding-top: 8px;
	}
	article pre{ background: none; border: none; padding: 0;}
	article .entry-content{text-align: left;}
	.share-comment{ padding: 25px 0px; clear: both;}
	hr{ margin: 20px 0px;border: 0; border-top:solid 1px #ddd;}
	</style>
  

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
				<header id="header" class="inner">
				 
				 	<div class="profilepic">
						<img src="https://raw.githubusercontent.com/Mekor/mekor.github.io/master/Blog/asset/icon.jpg" style="width:160px;">
					</div>
            	
					
					<h1><a href="index.html"></a></h1>
					<p class="subtitle"></p>
					<nav id="main-nav">
						<ul class="main">
						
						  <li id=""><a target="self" href="index.html">Home</a></li>
						
						  <li id=""><a target="_self" href="archives.html">Archives</a></li>
						
						</ul>
					</nav>

					<nav id="sub-nav">
						<div class="social">













								

								<a class="rss" href="atom.xml" title="RSS">RSS</a>
							
						</div>
					</nav>
				</header>				
			</div>
		</div>	
		<div class="mid-col">
			<div class="mid-col-container"> <div id="content" class="inner">
<div itemscope itemtype="http://schema.org/Blog">


	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-08-17T10:50:50+08:00" itemprop="datePublished">2016/8/17</time>
			</div>
			
			 
			
		</div>
		<h1 class="title" itemprop="name"><a href="14714022507551.html" itemprop="url">
		copy strong weak assign</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<h2 id="toc_0">weak &amp; strong</h2>

<p><strong>weak</strong><br/>
你买了个iPhone7，你朋友觉得不错，由于手头紧，没买，于是你们公用一台iPhone7，你新装了QQ音乐，你朋友用的时候也会有QQ音乐<br/>
然后你的手机丢了 你朋友也没有 不能用了</p>

<p><strong>stong</strong><br/>
你买了个iPhone7 你朋友也买了个iPhone7  他觉得你的app stroe账号里有好多软件 然后他就用你的app stroe账号 == 他stong了你的账号，你俩就公用了一个账号。<br/>
你下载软件 他也有了 然后你手机账号没了丢了 但他的手机还在账号还能用。 </p>

<h2 id="toc_1">strong &amp; copy (深拷贝&amp;浅拷贝)</h2>

<p>copy是用来保护数据的,copy一个数据之后,更改源数据不会导致copy的数据更改<br/>
strong是对一个数据的引用,更改源数据会导致strong的数据更改 </p>

<h2 id="toc_2">assign</h2>

<p>基本数据类型</p>

<blockquote>
<p><a href="https://developer.apple.com/library/mac/documentation/CoreFoundation/Conceptual/CFMemoryMgmt/Concepts/CopyFunctions.html">苹果文档中关于浅拷贝&amp;深拷贝</a></p>
</blockquote>

<p><img src="media/14714022507551/Snip20160817_3.png" alt="Snip20160817_3"/></p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-08-09T14:08:08+08:00" itemprop="datePublished">2016/8/9</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tips.html'>tips</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14707228889696.html" itemprop="url">
		scrollowView 添加tableView中遇到的位置不准确问题</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p><img src="media/14707228889696/14707230189128.jpg" alt=""/><br/>
添加tableView的时候tableView的<code>frame</code>是scrollowView的<code>bounds</code><br/>
<img src="media/14707228889696/Snip20160809_5.png" alt="Snip20160809_5"/><br/>
显示的时候tableView和scrollowView中间相差64.</p>

<p>解决办法:</p>

<pre><code>self.edgesForExtendedLayout = UIRectEdgeNone;
</code></pre>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-08-08T17:11:04+08:00" itemprop="datePublished">2016/8/8</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tips.html'>tips</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14706474647013.html" itemprop="url">
		collectionView遇到的问题</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>如果在自定义layout的时候调用 </p>

<pre><code>- (CGPoint)targetContentOffsetForProposedContentOffset:(CGPoint)proposedContentOffset withScrollingVelocity:(CGPoint)velocity
</code></pre>

<p>实现吸附效果,则有可能导致</p>

<pre><code>-(void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath
</code></pre>

<p>不执行...</p>

<p>如果把吸附效果写在</p>

<pre><code>-(void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset
</code></pre>

<p>则没有问题...暂时没有找到比较好的解决办法...</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-08-02T10:03:57+08:00" itemprop="datePublished">2016/8/2</time>
			</div>
			
			 
			
		</div>
		<h1 class="title" itemprop="name"><a href="14701034373615.html" itemprop="url">
		网络切面化处理</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<h2 id="toc_0">什么是面向切片编程</h2>

<blockquote>
<p>看考&lt;禅与Objective-C 编码艺术&gt;第11章  面向切面编程.  本文中技术部分参考<a href="https://github.com/yuantiku/YTKNetwork">YTKNetwork</a>和<a href="https://github.com/casatwy/RTNetworking">RTNetworking</a>代码实现,拜读了<a href="http://casatwy.com/iosying-yong-jia-gou-tan-wang-luo-ceng-she-ji-fang-an.html">iOS应用架构谈 网络层设计方案</a>和猿题库的两篇使用介绍并根据根据个人理解修改部分功能实现,这篇文章主要就是进行思路的整理,一步一步制造自己想要的网络请求轮子.</p>
</blockquote>

<p>Aspect Oriented Programming (AOP,面向切面编程)在OC中意味着可以通过运行时的特性来为切面添加合适的代码.简单说可以添加类似行为:</p>

<ul>
<li>在类的特定方法调用前运行特定的代码</li>
<li>在类的特定方法调用后运行特定的代码</li>
<li>增加代码来代替原来的类的方法的实现</li>
</ul>

<h2 id="toc_1">网络怎么切面</h2>

<p>上面已经说了什么是面向切面编程,那么网络中怎么切面?最主要的就是找到合适的方法,然后在它的前后都切一刀.由于项目中使用的是<a href="https://github.com/AFNetworking">AFNetworking</a>所以适合我们的特定方法应该是进行网络请求的关键代码,如下:</p>

<pre><code>/**
 Creates an `NSURLSessionDataTask` with the specified request.

 @param request The HTTP request for the request.
 @param completionHandler A block object to be executed when the task finishes. This block has no return value and takes three arguments: the server response, the response object created by that serializer, and the error that occurred, if any.
 */
- (NSURLSessionDataTask *)dataTaskWithRequest:(NSURLRequest *)request
                            completionHandler:(nullable void (^)(NSURLResponse *response, id _Nullable responseObject,  NSError * _Nullable error))completionHandler;
</code></pre>

<p>当然,如果需要上传下载进度的话</p>

<pre><code>/**
 Creates an `NSURLSessionDataTask` with the specified request.

 @param request The HTTP request for the request.
 @param uploadProgressBlock A block object to be executed when the upload progress is updated. Note this block is called on the session queue, not the main queue.
 @param downloadProgressBlock A block object to be executed when the download progress is updated. Note this block is called on the session queue, not the main queue.
 @param completionHandler A block object to be executed when the task finishes. This block has no return value and takes three arguments: the server response, the response object created by that serializer, and the error that occurred, if any.
 */
- (NSURLSessionDataTask *)dataTaskWithRequest:(NSURLRequest *)request
                               uploadProgress:(nullable void (^)(NSProgress *uploadProgress))uploadProgressBlock
                             downloadProgress:(nullable void (^)(NSProgress *downloadProgress))downloadProgressBlock
                            completionHandler:(nullable void (^)(NSURLResponse *response, id _Nullable responseObject,  NSError * _Nullable error))completionHandler;
</code></pre>

<p>这个应该是你的选择,这里只说下网络请求,所以就以第一种为例了.</p>

<p>我们能在网络请求之前与之后做些什么呢?</p>

<ul>
<li>操作网络请求之前(取消,判断是否重复...)</li>
<li>操作网络请求之后(缓存,错误处理...)</li>
<li>...</li>
</ul>

<h3 id="toc_2">进行网络请求核心代码</h3>

<pre><code>- (void)addRequest:(NSURLRequest *)request {
    NSLog(@&quot;\n==================================\n\nRequest Start: \n\n &quot;
          @&quot;%@\n\n==================================&quot;,
          request.URL);
    
    // 跑到这里的block的时候，就已经是主线程了。
    __block NSURLSessionDataTask *dataTask = nil;
    dataTask = [_manager
                dataTaskWithRequest:request
                completionHandler:^(NSURLResponse *_Nonnull response,
                                    id _Nullable responseObject,
                                    NSError *_Nullable error) {
                    NSNumber *requestID = @([dataTask taskIdentifier]);
                    [_requestsRecord removeObjectForKey:requestID];
                    NSData *responseData = responseObject;
                    NSString *responseString =
                    [[NSString alloc] initWithData:responseData
                                          encoding:NSUTF8StringEncoding];
                    
                    NSLog(@&quot;responseString:%@&quot;,responseString);
                    if (error) {
                        NSLog(@&quot;error: %@&quot;,error);
                        
#warning TODO: 失败回掉
                        NSLog(@&quot;这里应该进行失败回掉&quot;);
                    } else {
                        // 检查http response是否成立。
#warning TODO: 成功回掉
                        NSLog(@&quot;这里应该进行成功回掉&quot;);
                    }
                }];
    // 添加到请求列表
    NSNumber *requestId = @([dataTask taskIdentifier]);
    _requestsRecord[requestId] = dataTask;
    [dataTask resume];
}
</code></pre>

<h3 id="toc_3">创建NSMutableURLRequest</h3>

<p>需要NSMutableURLRequest参数,所以创建一个</p>

<pre><code>    AFHTTPRequestSerializer *httpRequestSerializer = [AFHTTPRequestSerializer serializer];
    httpRequestSerializer.timeoutInterval = 20.0f;
    httpRequestSerializer.cachePolicy = NSURLRequestUseProtocolCachePolicy;
    /// 网络请求头部插入一些内容
    [httpRequestSerializer setValue:[[NSUUID UUID] UUIDString] forHTTPHeaderField:@&quot;xxxxxxxx&quot;];
    NSMutableURLRequest *request = [httpRequestSerializer requestWithMethod:@&quot;GET&quot;
                                                                  URLString:@&quot;http://www.baidu.com&quot;
                                                                      parameters:nil
                                                                           error:NULL];
</code></pre>

<p>可以看到,上面注释的地方说明我们可以在这里搞事情啊,这个稍后会用到</p>

<p>对了,不要忘记设置<code>info.plist</code></p>

<pre><code>&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;
    &lt;dict&gt;
        &lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;
        &lt;true/&gt;
    &lt;/dict&gt;

</code></pre>

<p>创建request然后请求,<code>[[MKNetWorkAgent sharedInstance] addRequest:request];</code>结果如下,百度HTML页面去除了部分代码:</p>

<pre><code>2016-08-02 15:36:13.721 NetWorkDemo[56429:4922365] 
==================================

Request Start: 

 http://www.baidu.com

==================================
2016-08-02 15:36:13.838 NetWorkDemo[56429:4922365] responseString:&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;!--STATUS OK--&gt;
    &lt;head&gt;
        &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;
        &lt;title&gt;百度一下,你就知道&lt;/title&gt;
        &lt;meta http-equiv=&quot;Cache-control&quot; content=&quot;no-cache&quot;&gt;
        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no&quot;&gt;
        &lt;style type=&quot;text/css&quot;&gt;
            /*去掉css样式*/
        &lt;/style&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;wrap&quot;&gt;
            &lt;div class=&quot;lg&quot;&gt;
                &lt;img src=&quot;//m.baidu.com/static/index/u.png&quot; alt=&quot;百度首页&quot;&gt;
            &lt;/div&gt;
            &lt;form action=&quot;//m.baidu.com/s?&quot; method=&quot;get&quot;&gt;
                &lt;div class=&quot;word-wrap&quot;&gt;
                    &lt;input type=&quot;text&quot; name=&quot;word&quot; maxlength=&quot;64&quot; size=&quot;17&quot; id=&quot;word&quot;&gt;
                &lt;/div&gt;
                &lt;input type=&quot;submit&quot; value=&quot;百度一下&quot; class=&quot;bn&quot;&gt;
            &lt;/form&gt;
            &lt;div class=&quot;d&quot;&gt;
                &lt;!-- 去掉了尾部 --&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
2016-08-02 15:36:13.839 NetWorkDemo[56429:4922365] 这里应该进行成功回掉
</code></pre>

<p>这说明已经能够进行网络请求了.</p>

<p>........... 2016.8.3更新.............</p>

<blockquote>
<p>随着项目的增长,有些接口我们可能需要在不同的地方调用,这是需求把请求单独拿出来.在这里我们创建一个MKBaseRequest,所有的接口都继承自base,这样就能够满足我们的需求了.</p>
</blockquote>

<p>需求出来了,怎么解决呢?<br/>
首先修改进行网络请求核心代码为<code>- (void)addRequest:(MKBaseRequest *)request</code>,MKBaseRequest里面必须要提供可供访问的url,因为<code>NSURLRequest</code>的创建需要url.</p>

<p>在<code>MKBaseRequest</code>中添加:</p>

<pre><code>/// 请求的URL
- (NSString *)requestUrl;
</code></pre>

<p>使用方法而不是属性的原因就是为了方便子类的重写.<code>- (void)addRequest:(MKBaseRequest *)request</code>实现中由于没有<code>NSURLRequest</code>所以需要根据<code>MKBaseRequest</code>提供的url进行创建,添加代码:</p>

<pre><code>NSURLRequest *requestTest = [NSURLRequest requestWithURL:[NSURL URLWithString:[request requestUrl]]];
</code></pre>

<p>同理,我们还可以在<code>MKBaseRequest</code>中添加其他限制项,例如:</p>

<pre><code>/// 请求的BaseURL
- (NSString *)baseUrl;

/// 请求的cdnURL
- (NSString *)cdnUrl;

/// 请求的连接超时时间，默认为60秒
- (NSTimeInterval)requestTimeoutInterval;

/// 请求的参数列表
- (nullable id)requestArgument;

/// Http请求的方法
- (MKRequestMethod)requestMethod;

/// 是否使用cdn的host地址
- (BOOL)useCDN;
</code></pre>

<p>写到这里,如果我们很多接口都设置类似baseUrl之类的可以提取出来还有些必须的参数,在app进入的时候一起设置.这时我们需要创建<code>MKNetworkConfig</code>来管理这些内容.</p>

<p>........... 2016.8.4更新.............</p>

<h3 id="toc_4">本地模拟登陆</h3>

<p>做个简单的模拟登陆登陆页面:</p>

<pre><code>&lt;form action=&quot;welcome.php&quot; method=&quot;get&quot;&gt;&lt;br&gt;
    Name: &lt;input type=&quot;text&quot; name=&quot;name&quot; /&gt;&lt;br&gt;
    PWD:  &lt;input type=&quot;text&quot; name=&quot;pwd&quot; /&gt;&lt;br&gt;
    &lt;input type=&quot;submit&quot; /&gt; &lt;/form&gt;
</code></pre>

<p>welecome.php中简单的输出刚刚输入的内容.</p>

<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Citynight&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

您输入的账号是:

&lt;?php echo $_GET[&quot;name&quot;]; ?&gt;
.&lt;br /&gt;

密码是:

&lt;?php echo $_GET[&quot;pwd&quot;]; ?&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>登陆界面的样子:<br/>
<img src="media/14701034373615/14703212142675.jpg" alt=""/></p>

<p>点击提交后:<br/>
<img src="media/14701034373615/14703212477389.jpg" alt=""/><br/>
已经能够得到正确的结果了.</p>

<p>既然网页端没有问题,那么就修改成返回json格式数据给客户端</p>

<pre><code>&lt;?php
$map = array(
    &#39;name&#39; =&gt; $_GET[&quot;name&quot;],
    &#39;pwd&#39; =&gt; $_GET[&quot;pwd&quot;]
);
echo json_encode($map);
</code></pre>

<p>测试已经能够正常返回了:<br/>
<img src="media/14701034373615/14703247878224.jpg" alt=""/></p>

<h3 id="toc_5">怎样传递参数</h3>

<pre><code>/// 请求的参数列表
- (nullable id)requestArgument;
</code></pre>

<p>上面是原先设置的传递参数的方式,我感觉这样做不是很方便,比如需要传递的参数是变化的,可能就需要init的时候添加参数,这时如果参数的数量还比较多可能就比较麻烦了.<br/>
我现在采用的是通过代理的方法实现.</p>

<pre><code>/// 数据源:获得所需要的参数
@protocol MKRequestParamSource &lt;NSObject&gt;
@required
- (NSDictionary *)paramsForRequest:(MKBaseRequest *)request;
@end
</code></pre>

<p>我们创建的时候如果需要参数必须设置代理,并实现</p>

<pre><code>/// request paramSource
@property (nonatomic, weak, nullable) id&lt;MKRequestParamSource&gt; paramSource;
</code></pre>

<p>这样做是模仿数据源的代理方法,比较容易理解.</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-08-01T17:34:54+08:00" itemprop="datePublished">2016/8/1</time>
			</div>
			
			 
			
		</div>
		<h1 class="title" itemprop="name"><a href="14700440944204.html" itemprop="url">
		iOS Tips</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p><strong>对象销毁</strong><br/>
对象的销毁虽然消耗资源不多，但累积起来也是不容忽视的。通常当容器类持有大量对象时，其销毁时的资源消耗就非常明显。同样的，如果对象可以放到后台线程去释放，那就挪到后台线程去。这里有个小 Tip：把对象捕获到 block 中，然后扔到后台队列去随便发送个消息以避免编译器警告，就可以让对象在后台线程销毁了。</p>

<pre><code>NSArray *tmp = self.array;
self.array = nil;
dispatch_async(queue, ^{
    [tmp class];
});
</code></pre>

<blockquote>
<p>来自:<a href="http://blog.ibireme.com/2015/11/12/smooth_user_interfaces_for_ios/">iOS 保持界面流畅的技巧</a></p>
</blockquote>

<p><strong>拖拽收起键盘</strong><br/>
UIScrollView有个keyboardDismissMode属性，设置成UIScrollViewKeyboardDismissModeOnDrag就可以在拖拽ScrollView的时候自动缩起键盘</p>

<pre><code>@property(nonatomic) UIScrollViewKeyboardDismissMode keyboardDismissMode NS_AVAILABLE_IOS(7_0); // default is UIScrollViewKeyboardDismissModeNone
</code></pre>

<p><strong>让view的一部分响应手势点击</strong><br/>
让view的一部分响应手势点击，其余部分实现手势透传给下方的view的方法</p>

<p>在View中重写:</p>

<pre><code>-(UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event {
    NSLog(@&quot;%@-------------&gt;&gt;&gt;&gt;&gt;&gt;&gt;point = %@&quot;,NSStringFromSelector(_cmd),NSStringFromCGPoint(point));
    
    // 设置能够点击的区域
    CGRect rect = CGRectMake(100, 100, 200, 200);
    if (CGRectContainsPoint(rect, point)) {
        // 如果点击在该区域,则让View 成为响应链中的一个view,接受手势事件
        // 此时可通过touchBegan:方法监听到手势
        return self;
    }
    return nil;
}

</code></pre>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-07-24T21:00:20+08:00" itemprop="datePublished">2016/7/24</time>
			</div>
			
			 
			
		</div>
		<h1 class="title" itemprop="name"><a href="14693652209160.html" itemprop="url">
		Android Studio 中如何查看帮助文档</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<ol>
<li><p>首先下载帮助文档<br/>
<img src="media/14693652209160/14693653611930.jpg" alt=""/></p></li>
<li><p>跳转到文件夹<br/>
<img src="media/14693652209160/14693654229419.jpg" alt=""/></p></li>
<li><p>打开帮助文档 index.html<br/>
<img src="media/14693652209160/14693655187234.jpg" alt=""/></p></li>
<li><p>例如查找Activity 生命周期可以这样走<br/>
<img src="media/14693652209160/14693656858016.jpg" alt=""/><br/>
然后command + f 搜索Activity选中一个高亮的选项例如:<br/>
<img src="media/14693652209160/14693658027297.jpg" alt=""/><br/>
由于它是继承自Activity的所以可以这样<br/>
<img src="media/14693652209160/14693659242489.jpg" alt=""/><br/>
然后往下翻一翻就能看到了<br/>
<img src="media/14693652209160/14693659705775.jpg" alt=""/></p></li>
</ol>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-07-21T11:57:23+08:00" itemprop="datePublished">2016/7/21</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tips.html'>tips</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14690734433841.html" itemprop="url">
		一张图了解正则表达式</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p><img src="media/14690734433841/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.png" alt="正则表达式"/><br/>
(图片源自CSDN)</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-07-20T13:04:36+08:00" itemprop="datePublished">2016/7/20</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tips.html'>tips</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14689910761027.html" itemprop="url">
		关于签名(Certificate),Identifiers,Device和Provisioning Profile</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>直接上图:</p>

<p><img src="media/14689910761027/%E6%80%BB%E7%BB%93.png" alt="总结"/></p>

<p>应该很详细了</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-07-20T10:49:05+08:00" itemprop="datePublished">2016/7/20</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tips.html'>tips</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14689829459214.html" itemprop="url">
		Python爬网站上的图片</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>以<a href="http://ppt.geekbang.org">极客邦PPT大全</a>为例,比如我想下载<a href="http://ppt.geekbang.org/slide/show/204">美团iOS客户端的构建思考与实践</a></p>

<ol>
<li>查看图片url
<img src="media/14689829459214/14689832970971.jpg" alt=""/></li>
<li>图片url的格式<a href="http://7xiox7.com2.z0.glb.qiniucdn.com/576e52fb28bf9-01.jpg">http://7xiox7.com2.z0.glb.qiniucdn.com/576e52fb28bf9-01.jpg</a>  总共101张图片</li>
<li>根据这些编写Python文件</li>
</ol>

<pre><code>#!/usr/bin/python
#coding:utf-8

import urllib
import urllib2
import os

basepicurl=&quot;http://7xiox7.com2.z0.glb.qiniucdn.com/576e52fb28bf9-&quot;
save_path=&quot;/Users/mekor/Desktop/images/&quot;
for i in range(1,102,1):
    s = &quot;%02d&quot; % i
    picurl = basepicurl + s + &quot;.jpg&quot;
    imgData = urllib2.urlopen(picurl).read()
    # 给定图片存放名称
    fileName = save_path + s + &quot;.jpg&quot;
    # 文件名是否存在
    #if os.path.exists(fileName):
    output = open(fileName,&#39;wb+&#39;)
    output.write(imgData)
    output.close()
    print &quot;Finished download&quot;+ s

print &quot;运行完成&quot;
</code></pre>

<p>这样就能够把所有的图片爬到本地了.</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-07-14T21:38:08+08:00" itemprop="datePublished">2016/7/14</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tips.html'>tips</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14685034880390.html" itemprop="url">
		Mac 下面Python 自动补全</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>网上有很多tab自动补全的脚本,但是在Mac上面都不能正常的运行,在<a href="http://stackoverflow.com/questions/7116038/python-tab-completion-mac-osx-10-7-lion">stackoverflow</a>找到一个能用的.</p>

<pre><code>import readline
import rlcompleter
if &#39;libedit&#39; in readline.__doc__:
    readline.parse_and_bind(&quot;bind ^I rl_complete&quot;)
else:
    readline.parse_and_bind(&quot;tab: complete&quot;)

</code></pre>

<p>进入Python后直接import tab 就可以了</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-07-11T20:39:09+08:00" itemprop="datePublished">2016/7/11</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tips.html'>tips</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14682407498601.html" itemprop="url">
		如何给View添加点击事件</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>项目中有很多地方需要添加点击事件,重复代码很多,所以做了一个UIView的分类,专门做点击事件使用.<br/>
项目地址:<a href="https://github.com/Mekor/UIView-Tap">UIView-Tap</a></p>

<p>代码很简单,主要有一点就是注意分类不能直接添加属性,需要用到运行时相关内容.</p>

<p>代码如下:</p>

<pre><code>\\UIView+Tap.h文件
@interface UIView (Tap)
- (void)addTapBlock:(void(^)(id obj))tapAction;
@end

\\UIView+Tap.m文件
#import &lt;objc/runtime.h&gt;

static const void* tagValue = &amp;tagValue;

@interface UIView ()
@property (nonatomic, copy) void(^tapAction)(id);
@end

@implementation UIView (Tap)
- (void)tap{
    if (self.tapAction) {
        self.tapAction(self);
    }
}
- (void)addTapBlock:(void(^)(id obj))tapAction{
    self.tapAction = tapAction;
    if (![self gestureRecognizers]) {
        self.userInteractionEnabled = YES;
        UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tap)];
        [self addGestureRecognizer:tap];
    }
}

-(void)setTapAction:(void (^)(id))tapAction {
    objc_setAssociatedObject(self, tagValue, tapAction, OBJC_ASSOCIATION_COPY_NONATOMIC);
}
-(void (^)(id))tapAction {
    return objc_getAssociatedObject(self, tagValue);
}
@end
</code></pre>

<p>正如大家所见,如果要接收点击事件,必须userInteractionEnabled设置为YES,所以不管怎么只要确认要给视图添加点击事件,都会被设置为<code>userInteractionEnabled = YES</code></p>

<p>简单实用:</p>

<pre><code>UIView *redView = [[UIView alloc]initWithFrame:CGRectMake(100, 100, 100, 100)];
redView.backgroundColor = [UIColor redColor];
[redView addTapBlock:^(UIView* obj) {
    NSLog(@&quot;redView%@&quot;,obj.backgroundColor);
}];
[self.view addSubview:redView];

UIImageView *imageView = [[UIImageView alloc]initWithFrame:CGRectMake(50, 250, 100, 100)];
imageView.image = [UIImage imageNamed:@&quot;icon&quot;];
[imageView addTapBlock:^(UIImageView* obj) {
    NSLog(@&quot;imageView:\n%@&quot;,obj.image);
}];
[self.view addSubview:imageView];

UILabel *label = [[UILabel alloc]initWithFrame:CGRectMake(150, 400, 100, 100)];
label.text = @&quot;这是label,点击这里...&quot;;
[label addTapBlock:^(UILabel* obj) {
    NSLog(@&quot;label:\n%@&quot;,obj.text);
}];
[self.view addSubview:label];

</code></pre>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-07-07T10:48:38+08:00" itemprop="datePublished">2016/7/7</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tips.html'>tips</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14678597180657.html" itemprop="url">
		关于tableViewCell加载图片优化</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>cell的创建</p>

<pre><code>- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
</code></pre>

<p>数据处理建议在这里进行:</p>

<pre><code>-(void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
</code></pre>

<p>cell将要显示的时候我们进行一些处理(来自苹果Demo)</p>

<pre><code>// Only load cached images; defer new downloads until scrolling ends
if (!appRecord.appIcon)
{
    if (self.tableView.dragging == NO &amp;&amp; self.tableView.decelerating == NO)
    {
        [self startIconDownload:appRecord forIndexPath:indexPath];
    }
    // if a download is deferred or in progress, return a placeholder image
    cell.imageView.image = [UIImage imageNamed:@&quot;Placeholder.png&quot;];
}
else
{
    cell.imageView.image = appRecord.appIcon;
}
</code></pre>

<p>这里可以看出,拖拽和滚动的时候不进行图片下载,只有停止的时候才进行.当然我们还需要在scrollView停止滚动和拖拽的时候进行下载</p>

<pre><code>#pragma mark - UIScrollViewDelegate

// -------------------------------------------------------------------------------
//  scrollViewDidEndDragging:willDecelerate:
//  Load images for all onscreen rows when scrolling is finished.
// -------------------------------------------------------------------------------
- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate
{
    if (!decelerate)
    {
        [self loadImagesForOnscreenRows];
    }
}

// -------------------------------------------------------------------------------
//  scrollViewDidEndDecelerating:scrollView
//  When scrolling stops, proceed to load the app icons that are on screen.
// -------------------------------------------------------------------------------
- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView
{
    [self loadImagesForOnscreenRows];
}

</code></pre>

<p>下载显示cell的图片</p>

<pre><code>// -------------------------------------------------------------------------------
//  loadImagesForOnscreenRows
//  This method is used in case the user scrolled into a set of cells that don&#39;t
//  have their app icons yet.
// -------------------------------------------------------------------------------
- (void)loadImagesForOnscreenRows
{
    if (self.entries.count &gt; 0)
    {
        NSArray *visiblePaths = [self.tableView indexPathsForVisibleRows];
        for (NSIndexPath *indexPath in visiblePaths)
        {
            AppRecord *appRecord = (self.entries)[indexPath.row];
            
            if (!appRecord.appIcon)
            // Avoid the app icon download if the app already has an icon
            {
                [self startIconDownload:appRecord forIndexPath:indexPath];
            }
        }
    }
}
</code></pre>

<p>具体下载:</p>

<pre><code>#pragma mark - Table cell image support

// -------------------------------------------------------------------------------
//  startIconDownload:forIndexPath:
// -------------------------------------------------------------------------------
- (void)startIconDownload:(AppRecord *)appRecord forIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@&quot;下载图片&quot;);
    IconDownloader *iconDownloader = (self.imageDownloadsInProgress)[indexPath];
    if (iconDownloader == nil) 
    {
        iconDownloader = [[IconDownloader alloc] init];
        iconDownloader.appRecord = appRecord;
        [iconDownloader setCompletionHandler:^{
            
            UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];
            
            // Display the newly loaded image
            cell.imageView.image = appRecord.appIcon;
            
            // Remove the IconDownloader from the in progress list.
            // This will result in it being deallocated.
            [self.imageDownloadsInProgress removeObjectForKey:indexPath];
            
        }];
        (self.imageDownloadsInProgress)[indexPath] = iconDownloader;
        [iconDownloader startDownload];  
    }
}
</code></pre>

<p>IconDownloader文件</p>

<pre><code>//.h文件
@class AppRecord;

@interface IconDownloader : NSObject

@property (nonatomic, strong) AppRecord *appRecord;
@property (nonatomic, copy) void (^completionHandler)(void);

- (void)startDownload;
- (void)cancelDownload;

@end


//.m文件
#import &quot;IconDownloader.h&quot;
#import &quot;AppRecord.h&quot;

#define kAppIconSize 48


@interface IconDownloader ()

@property (nonatomic, strong) NSURLSessionDataTask *sessionTask;

@end


#pragma mark -

@implementation IconDownloader

// -------------------------------------------------------------------------------
//  startDownload
// -------------------------------------------------------------------------------
- (void)startDownload
{
    NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:self.appRecord.imageURLString]];

    // create an session data task to obtain and download the app icon
    _sessionTask = [[NSURLSession sharedSession] dataTaskWithRequest:request
                                                   completionHandler:^(NSData *data, NSURLResponse *response, NSError *error) {
        
        // in case we want to know the response status code
        //NSInteger HTTPStatusCode = [(NSHTTPURLResponse *)response statusCode];

        if (error != nil)
        {
            if ([error code] == NSURLErrorAppTransportSecurityRequiresSecureConnection)
            {
                // if you get error NSURLErrorAppTransportSecurityRequiresSecureConnection (-1022),
                // then your Info.plist has not been properly configured to match the target server.
                //
                abort();
            }
        }
                                                       
        [[NSOperationQueue mainQueue] addOperationWithBlock: ^{
            
            // Set appIcon and clear temporary data/image
            UIImage *image = [[UIImage alloc] initWithData:data];
            
            if (image.size.width != kAppIconSize || image.size.height != kAppIconSize)
            {
                CGSize itemSize = CGSizeMake(kAppIconSize, kAppIconSize);
                UIGraphicsBeginImageContextWithOptions(itemSize, NO, 0.0f);
                CGRect imageRect = CGRectMake(0.0, 0.0, itemSize.width, itemSize.height);
                [image drawInRect:imageRect];
                self.appRecord.appIcon = UIGraphicsGetImageFromCurrentImageContext();
                UIGraphicsEndImageContext();
            }
            else
            {
                self.appRecord.appIcon = image;
            }
            
            // call our completion handler to tell our client that our icon is ready for display
            if (self.completionHandler != nil)
            {
                self.completionHandler();
            }
        }];
    }];
    
    [self.sessionTask resume];
}

// -------------------------------------------------------------------------------
//  cancelDownload
// -------------------------------------------------------------------------------
- (void)cancelDownload
{
    [self.sessionTask cancel];
    _sessionTask = nil;
}
</code></pre>

<blockquote>
<p><a href="https://developer.apple.com/library/ios/samplecode/LazyTableImages/Introduction/Intro.html">Apple Demo</a></p>
</blockquote>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-07-05T15:17:12+08:00" itemprop="datePublished">2016/7/5</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tips.html'>tips</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14677030322532.html" itemprop="url">
		键盘消失后又再次显示并立即消失问题</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>Keyboard will appeared automatically while displaying alertview or alertcontroller</p>

<blockquote>
<p><a href="http://stackoverflow.com/questions/30498972/keyboard-will-appeared-automatically-in-ios-8-3-while-displaying-alertview-or-al">stackoverflow</a></p>
</blockquote>

<p>我采用其中</p>

<pre><code> [YOUR_TEXT resignFirstResponder];
            dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(.6 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^{


                    _alertVw = [[UIAlertView alloc] initWithTitle:@&quot;&quot; message:@&quot;message.&quot; delegate:self cancelButtonTitle:@&quot;Ok&quot; otherButtonTitles:nil, nil];

                    [_alertVw show];
});

</code></pre>

<p>这种方案解决的</p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-07-05T14:21:33+08:00" itemprop="datePublished">2016/7/5</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tool.html'>tool</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14676996936809.html" itemprop="url">
		为项目添加podspec</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<blockquote>
<p>全文来自:<a href="http://www.jianshu.com/p/d7d1942dd3f1">iOS开发-- 创建podspec文件，为自己的项目添加pod支持</a> 只是在文章中添加了原文没有说明的东西&amp;步骤</p>
</blockquote>

<h2 id="toc_0">1.clone项目源码</h2>

<p>项目如果没有在github仓库中,先上传到github仓库,然后clone到本地,已经存在就直接clone到本地</p>

<pre><code>// cd 到 想要存放项目的文件夹中执行
git clone https://github.com/Mekor/MKScanner.git
</code></pre>

<p><code>https://github.com/Mekor/MKScanner.git</code>这个是我自己的仓库,这个仓库地址可以在这里找到<br/>
<img src="media/14676996936809/Snip20160705_4.png" alt="Snip20160705_4"/></p>

<h2 id="toc_1">2. 创建项目的podspec文件</h2>

<p>•   用终端命令cd到本地项目目录并执行如下命令:</p>

<pre><code>$ pod spec create MKScanner
</code></pre>

<p>MKScanner替换为自己的项目名称,这时在本地就会生成一个MKScanner.podspec</p>

<p>•   用编辑器打开.podspec文件 (我自己用Sublime Text)<br/>
删除不必要的注释(这里只简单介绍基本用法，所以只用到一部分必须得字段 更多字段请移步<a href="http://guides.cocoapods.org/syntax/podspec.html">http://guides.cocoapods.org/syntax/podspec.html</a></p>

<pre><code>Pod::Spec.new do |s|

  s.name                 = &quot;MKScanner&quot;
  s.version              = &quot;0.0.1&quot;
  s.summary              = &quot;QRCode Scanner&quot;
  s.homepage             = &quot;https://github.com/Mekor/MKScanner&quot;
  s.license              = { :type =&gt; &quot;MIT&quot;, :file =&gt; &quot;LICENSE&quot; }
  s.author             = { &quot;Mekor&quot; =&gt; &quot;mekor@live.cn&quot; }
  s.social_media_url   = &quot;http://weibo.com/gliii&quot;
  s.platform             = :ios, &quot;7.0&quot;
  s.source               = { :git =&gt; &quot;https://github.com/Mekor/MKScanner.git&quot;, :tag =&gt; s.version }
  s.source_files          = &quot;MKScanner/**/*.{h,m}&quot;
  #s.resources          = &quot;MKScanner/**/*.png&quot;
  s.requires_arc         = true

end
</code></pre>

<p>•   验证podspec文件</p>

<p>编辑完podspec文件后需要验证一下这个文件是否可用podspec文件不允许有任何的Warning或者Error<br/>
执行命令</p>

<pre><code>$ pod lib lint
</code></pre>

<p>如果出现</p>

<pre><code>-&gt; MKScanner (0.0.1)
MKScanner passed validation.
</code></pre>

<p>则说明验证通过， 否则， 根据提示修改podspec文件再次验证直到验证通过<br/>
附带说一下，Xcode允许警告存在，所以可以通过命令屏蔽警告</p>

<pre><code>$ pod lib lint --allow-warnings
</code></pre>

<p>如果出现Error但是提示信息不足，可以添加--verbose 以获取更多错误信息</p>

<pre><code>$ pod lib lint --verbose
</code></pre>

<h2 id="toc_2">3. 打tag 上传podspec</h2>

<p>podspec文件中需要指定的tag， 完成上述操作后给项目打tag</p>

<pre><code>$ git tag -m&quot;first release MKScanner with podspec&quot; &quot;0.0.1&quot;
$ git push --tags

</code></pre>

<p>最后使用pod trunk命令，把podspec文件推送到CocoaPod官方库<br/>
pod trunk 需要注册,参见:<a href="https://guides.cocoapods.org/making/getting-setup-with-trunk.html">https://guides.cocoapods.org/making/getting-setup-with-trunk.html</a><br/>
其实很简单:</p>

<pre><code>pod trunk register Mekor@live.cn &quot;Mekor&quot;
</code></pre>

<p>指明你的邮箱地址（spec文件中的）和名称<br/>
CocoaPods 会给你填写的邮箱发送验证邮件，点击邮件中的链接就可通过验证。<br/>
pod trunk 设置完毕后执行命令</p>

<pre><code>$ pod trunk push MKScanner.podspec
</code></pre>

<p>这个过程可能会比较耗时，原因你懂的</p>

<h2 id="toc_3">4. 最后</h2>

<p>如果一切顺利</p>

<pre><code>pod search MKScanner
</code></pre>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-07-05T10:51:34+08:00" itemprop="datePublished">2016/7/5</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tips.html'>tips</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14676870942237.html" itemprop="url">
		AFN3.0 如何实现operation.responseString</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>我在AFNetworking issues中的回答<a href="https://github.com/AFNetworking/AFNetworking/issues/3551">how to get response body in failure block?</a>还有<br/>
<a href="https://github.com/AFNetworking/AFNetworking/issues/3534">How can i get responseString which at AFNetworking 3.0</a></p>

<p>发现还有好多朋友还不清楚如何实现,其实很简单</p>

<pre><code>NSError *underError = error.userInfo[@&quot;NSUnderlyingError&quot;];
NSData *responseData = underError.userInfo[@&quot;com.alamofire.serialization.response.error.data&quot;];
</code></pre>

<p>有小伙伴问我<code>com.alamofire.serialization.response.error.data</code>是怎么来的,原来都是AFJSONResponseSerializer解析修改成<code>manager.responseSerializer = [AFHTTPResponseSerializer serializer];</code>这样报错的时候就会看到控制台打印的信息里面有<code>com.alamofire.serialization.response.error.data</code>后面输出responseData...然后才有了上面的解决办法</p>

<p><strong>-----16.6.7更-----</strong><br/>
作者回复中已经添加了相关操作<br/>
在<code>AFURLResponseSerialization</code><br/>
可以在 failure block 中添加下面代码获取responseString</p>

<pre><code>NSData *data = error.userInfo[AFNetworkingOperationFailingURLResponseDataErrorKey];
</code></pre>

<p>具体代码:</p>

<pre><code>/**
 ## User info dictionary keys

 These keys may exist in the user info dictionary, in addition to those defined for NSError.

 - `NSString * const AFNetworkingOperationFailingURLResponseErrorKey`
 - `NSString * const AFNetworkingOperationFailingURLResponseDataErrorKey`

 ### Constants

 `AFNetworkingOperationFailingURLResponseErrorKey`
 The corresponding value is an `NSURLResponse` containing the response of the operation associated with an error. This key is only present in the `AFURLResponseSerializationErrorDomain`.

 `AFNetworkingOperationFailingURLResponseDataErrorKey`
 The corresponding value is an `NSData` containing the original data of the operation associated with an error. This key is only present in the `AFURLResponseSerializationErrorDomain`.
 */
FOUNDATION_EXPORT NSString * const AFNetworkingOperationFailingURLResponseErrorKey;

FOUNDATION_EXPORT NSString * const AFNetworkingOperationFailingURLResponseDataErrorKey;
</code></pre>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-07-05T10:36:45+08:00" itemprop="datePublished">2016/7/5</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tips.html'>tips</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14676862053982.html" itemprop="url">
		如何解决json字符串中包含制表符</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>错误信息:</p>

<pre><code>Error Domain=NSCocoaErrorDomain Code=3840 &quot;The operation couldn’t be completed. (Cocoa error 3840.)&quot; (Unescaped control character around character 135.) UserInfo=0x170e79d00 {NSDebugDescription=Unescaped control character around character 135.}
</code></pre>

<p>如何处理:<br/>
最关键的地方:</p>

<pre><code>-(NSString *)removeUnescapedCharacter:(NSString *)inputStr
{
    NSCharacterSet *controlChars = [NSCharacterSet controlCharacterSet];//获取那些特殊字符
    NSRange range = [inputStr rangeOfCharacterFromSet:controlChars];//寻找字符串中有没有这些特殊字符
    if (range.location != NSNotFound)
        {
        NSMutableString *mutable = [NSMutableString stringWithString:inputStr];
        while (range.location != NSNotFound)
            {
            [mutable deleteCharactersInRange:range];//去掉这些特殊字符
            range = [mutable rangeOfCharacterFromSet:controlChars];
            }
        return mutable;
        }
    return inputStr;
}

</code></pre>

<p>举例:</p>

<pre><code>
    NSString *responseString = [NSMutableString stringWithString:[request responseString]];
    responseString =[self removeUnescapedCharacter:responseString];
    NSData *jsonData = [responseString dataUsingEncoding:NSUTF8StringEncoding];
    NSError *error;
    NSDictionary * dic = [NSJSONSerialization JSONObjectWithData:jsonData options:0 error:&amp;error];
    
</code></pre>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-07-04T13:45:12+08:00" itemprop="datePublished">2016/7/4</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tips.html'>tips</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14676111126987.html" itemprop="url">
		Coding中检测系统授权状态，关闭提示用户去隐私设置中打开</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<blockquote>
<p>参考Coding项目,二维码扫描中使用到,大家可以参考:<a href="https://github.com/Mekor/MKScanner">MKScanner</a></p>
</blockquote>

<p>Helper.h文件</p>

<pre><code>#import &lt;Foundation/Foundation.h&gt;

@interface Helper : NSObject

/**
 * 检查系统&quot;照片&quot;授权状态, 如果权限被关闭, 提示用户去隐私设置中打开.
 */
+ (BOOL)checkPhotoLibraryAuthorizationStatus;

/**
 * 检查系统&quot;相机&quot;授权状态, 如果权限被关闭, 提示用户去隐私设置中打开.
 */
+ (BOOL)checkCameraAuthorizationStatus;

@end
</code></pre>

<p>Helper.m文件</p>

<pre><code>#import &quot;Helper.h&quot;
@import AVFoundation;

@implementation Helper

+ (BOOL)checkPhotoLibraryAuthorizationStatus
{
    if ([ALAssetsLibrary respondsToSelector:@selector(authorizationStatus)]) {
        ALAuthorizationStatus authStatus = [ALAssetsLibrary authorizationStatus];
        if (ALAuthorizationStatusDenied == authStatus ||
            ALAuthorizationStatusRestricted == authStatus) {
            [self showSettingAlertStr:@&quot;请在iPhone的“设置-&gt;隐私-&gt;照片”中打开本应用的访问权限&quot;];
            return NO;
        }
    }
    return YES;
}

+ (BOOL)checkCameraAuthorizationStatus
{
    if (![UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera]) {
        kTipAlert(@&quot;该设备不支持拍照&quot;);
        return NO;
    }
    
    if ([AVCaptureDevice respondsToSelector:@selector(authorizationStatusForMediaType:)]) {
        AVAuthorizationStatus authStatus = [AVCaptureDevice authorizationStatusForMediaType:AVMediaTypeVideo];
        if (AVAuthorizationStatusDenied == authStatus ||
            AVAuthorizationStatusRestricted == authStatus) {
            [self showSettingAlertStr:@&quot;请在iPhone的“设置-&gt;隐私-&gt;相机”中打开本应用的访问权限&quot;];
            return NO;
        }
    }
    
    return YES;
}

+ (void)showSettingAlertStr:(NSString *)tipStr{
    //iOS8+系统下可跳转到‘设置’页面，否则只弹出提示窗即可
    if (floor(NSFoundationVersionNumber) &gt; NSFoundationVersionNumber_iOS_7_1) {
        UIAlertView *alertView = [UIAlertView bk_alertViewWithTitle:@&quot;提示&quot; message:tipStr];
        [alertView bk_setCancelButtonWithTitle:@&quot;取消&quot; handler:nil];
        [alertView bk_addButtonWithTitle:@&quot;设置&quot; handler:nil];
        [alertView bk_setDidDismissBlock:^(UIAlertView *alert, NSInteger index) {
            if (index == 1) {
                UIApplication *app = [UIApplication sharedApplication];
                NSURL *settingsURL = [NSURL URLWithString:UIApplicationOpenSettingsURLString];
                if ([app canOpenURL:settingsURL]) {
                    [app openURL:settingsURL];
                }
            }
        }];
        [alertView show];
    }else{
        kTipAlert(@&quot;%@&quot;, tipStr);
    }
}

@end

</code></pre>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-07-04T13:36:10+08:00" itemprop="datePublished">2016/7/4</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tips.html'>tips</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14676105703423.html" itemprop="url">
		忽略编译器警告</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<h2 id="toc_0">第一种方法</h2>

<p>举例<br/>
<img src="media/14672570618572/14672571503878.jpg" alt=""/><br/>
<img src="media/14672570618572/14672573103735.jpg" alt=""/><br/>
接下来,<br/>
<img src="media/14672570618572/14672575411986.jpg" alt=""/><br/>
<img src="media/14672570618572/14672577757507.jpg" alt=""/></p>

<h2 id="toc_1">第二种方法</h2>

<pre><code>#pragma clang diagnostic push
#pragma clang diagnostic ignored&quot; -Wcompare-distinct-pointer-types&quot;
    //写在这个中间的代码,都不会被编译器提示-Wcompare-distinct-pointer-types
#pragma clang diagnostic pop 
</code></pre>

<h2 id="toc_2">Xib警告: This file is set to build for a version older than the deployment target. Functionality may be limited.</h2>

<p>类似于这种<br/>
<img src="media/14672570618572/14672589919425.jpg" alt=""/></p>

<p>双击进入Xib文件<br/>
<img src="media/14672570618572/14672592962938.jpg" alt=""/><br/>
OK,这样就没有警告了</p>

<h2 id="toc_3">非源文件参与编译错误</h2>

<p><img src="media/14672570618572/Snip20160630_15.png" alt="Snip20160630_15"/><br/>
项目中有一个README.md的文件,这个文件主要记录使用第三方的一些情况,默认就参与编译了,我们需要这样做</p>

<p><img src="media/14672570618572/Snip20160630_16.png" alt="Snip20160630_16"/></p>

<p>找到这个文件,然后移除,这样就不会有问题了.<br/>
参考: <a href="http://stackoverflow.com/questions/6509600/compilation-warning-no-rule-to-process-file-for-architecture-i386">compilation warning: no rule to process file for architecture i386</a></p>


			
			
		</div>

	</article>
 
	<article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
		<div class="meta">
			<div class="date">
				<time datetime="2016-07-04T13:29:59+08:00" itemprop="datePublished">2016/7/4</time>
			</div>
			<div class="tags">posted in 
			
			    <a class='category' href='tips.html'>tips</a>&nbsp;
			 
			</div>
		</div>
		<h1 class="title" itemprop="name"><a href="14676101998537.html" itemprop="url">
		百度坐标&火星坐标转换</a></h1>
		<div class="entry-content" itemprop="articleBody">
			
			<p>LocationHelper.h文件</p>

<pre><code>#import &lt;Foundation/Foundation.h&gt;
#import &lt;CoreLocation/CoreLocation.h&gt;

@interface LocationHelper : NSObject

//百度转火星坐标
+ (CLLocationCoordinate2D )bdToGGEncrypt:(CLLocationCoordinate2D)coord;
//火星转百度坐标
+ (CLLocationCoordinate2D )ggToBDEncrypt:(CLLocationCoordinate2D)coord;

@end
</code></pre>

<p>LocationHelper.m文件</p>

<pre><code>//
//  LocationHelper.m
//  Coding_iOS
//
//  Created by Kevin on 3/21/15.
//  Copyright (c) 2015 Coding. All rights reserved.
//

#import &quot;LocationHelper.h&quot;

@implementation LocationHelper

//百度转火星坐标
+ (CLLocationCoordinate2D )bdToGGEncrypt:(CLLocationCoordinate2D)coord
{
    double x = coord.longitude - 0.0065, y = coord.latitude - 0.006;
    double z = sqrt(x * x + y * y) - 0.00002 * sin(y * M_PI);
    double theta = atan2(y, x) - 0.000003 * cos(x * M_PI);
    CLLocationCoordinate2D transformLocation ;
    transformLocation.longitude = z * cos(theta);
    transformLocation.latitude = z * sin(theta);
    return transformLocation;
}

//火星坐标转百度坐标
+ (CLLocationCoordinate2D )ggToBDEncrypt:(CLLocationCoordinate2D)coord
{
    double x = coord.longitude, y = coord.latitude;
    
    double z = sqrt(x * x + y * y) + 0.00002 * sin(y * M_PI);
    double theta = atan2(y, x) + 0.000003 * cos(x * M_PI);
    
    CLLocationCoordinate2D transformLocation ;
    transformLocation.longitude = z * cos(theta) + 0.0065;
    transformLocation.latitude = z * sin(theta) + 0.006;
    
    return transformLocation;
}

@end

</code></pre>


			
			
		</div>

	</article>
  

</div>
<nav id="pagenavi">
	 
	
	<div class="center"><a href="archives.html">Blog Archives</a></div>

</nav>

</div>



        </div>
			<footer id="footer" class="inner">Copyright &copy; 2014
Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a> &nbsp;&nbsp; 
Theme by <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a>
      </footer>
		</div>
	</div>

  
    



</body>
</html>